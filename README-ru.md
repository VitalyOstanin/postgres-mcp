# PostgreSQL Model Context Protocol (MCP) Server

MCP сервер для комплексной интеграции с PostgreSQL: операции с базами данных, таблицами, запросы, управление подключениями, мониторинг.

## Возможности

- Подключение к PostgreSQL базам данных через строку подключения
- Режим только для чтения с использованием транзакционного режима PostgreSQL
- Комплексный набор инструментов для операций с базой данных
- Поддержка больших наборов данных через стриминг
- Реализация стандартного протокола MCP

## Требования

- Node.js >= 20.0.0
- Доступный сервер PostgreSQL

## Установка

```bash
npm install -g @vitalyostanin/postgres-mcp
```

## Использование

```bash
# Установите переменную окружения со строкой подключения
export POSTGRES_MCP_CONNECTION_STRING="postgresql://username:password@host:port/database"

# Запустите MCP сервер
postgres-mcp --read-only --pool-size=5
```

### Параметры командной строки

- `--read-only`: Запуск в режиме только для чтения (по умолчанию: true)
- `--auto-connect`: Автоматическое подключение к PostgreSQL при запуске (по умолчанию: false)
- `--pool-size`: Размер пула соединений (по умолчанию: 1)

## Переменные окружения

- `POSTGRES_MCP_CONNECTION_STRING`: Строка подключения к PostgreSQL
- `POSTGRES_MCP_TIMEZONE`: Часовой пояс для операций с датами (по умолчанию: Europe/Moscow)
- `POSTGRES_MCP_POOL_SIZE`: Размер пула соединений (значение по умолчанию переопределяется параметром CLI --pool-size)

## Инструменты

Сервер предоставляет следующие инструменты:

### Инструменты подключения
- `connect`: Подключение к PostgreSQL
- `disconnect`: Отключение от PostgreSQL
- `service_info`: Получение информации о сервисе и состоянии подключения

### Инструменты исследования базы данных
- `list-databases`: Список всех баз данных
- `list-schemas`: Список всех схем в базе данных
- `list-tables`: Список всех таблиц в схеме
- `list-columns`: Список всех колонок в таблице
- `table-info`: Получение информации о таблице (размер, количество строк и т.д.)

### Инструменты операций с данными
- `select`: Выполнение SELECT запросов
- `find`: Запрос данных из таблиц
- `count`: Подсчет записей в таблицах
- `insert`: Вставка записей
- `update`: Обновление записей
- `delete`: Удаление записей
- `query`: Выполнение произвольных SQL запросов
- `execute`: Выполнение произвольных SQL команд

### Инструменты операций со схемой
- `create-table`: Создание новой таблицы
- `drop-table`: Удаление таблицы
- `create-index`: Создание индекса
- `drop-index`: Удаление индекса
- `alter-table`: Изменение структуры таблицы

### Инструменты анализа
- `explain`: Анализ плана выполнения запроса
- `postgresql-logs`: Получение логов PostgreSQL
- `db-stats`: Получение статистики базы данных

## Лицензия

MIT